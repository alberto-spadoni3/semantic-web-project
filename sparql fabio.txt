PREFIX dcterm: <http://purl.org/dc/terms/>
PREFIX dct: <http://purl.org/dc/terms/>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dt: <http://dbpedia.org/datatype/>
PREFIX sc: <http://purl.org/science/owl/sciencecommons/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX schema: <https://schema.org/>
PREFIX dbpedia: <http://dbpedia.org/ontology/>

PREFIX anime: <http://www.semanticweb.org/ontology/anime/>

################################# QUERY DI TEST #####################################

## tutti i nomi alternativi dell'anime "Attack on Titan"
#SELECT ?subject ?linkedObjectTitle
#  WHERE {
#  ?subject dcterms:title "Attack on Titan" ;
#           dcterms:title ?linkedObjectTitle .
#  
#}

## tutti i character dell'anime "Attack on Titan" e voiceActor, language relativi
#SELECT ?linkedCharacter ?linkedActor ?language ?languageName
#  WHERE {
#  ?subject dcterms:title "Attack on Titan" ;
#           schema:character ?linkedCharacter .
#  ?linkedCharacter anime:hasVoiceActor ?linkedActor .
#  ?linkedActor anime:languageOfVoicing ?language .
#  ?language dcterms:title ?languageName . #"ja-JP" 
#}

# tutte anime usciti nella stagione Spring 2017
#SELECT  ?subject
#  WHERE {
#  ?subject anime:meteorologicalSeason "Spring 2017" .
#}

# tutti gli anime che hanno una relazione con dragon ball
#SELECT  ?object
#  WHERE {
#  ?subject dcterms:title "Dragon Ball"@en ;
#  	anime:hasRelation ?object .
#}

# tutti gli anime che hanno una relazione con dragon ball + tipologia opera (spin off/sequel, tv / film) ed ordinati per data di uscita
#SELECT  ?object
#  WHERE {
#  ?subject dcterms:title "Dragon Ball"@en ;
#  	anime:hasRelation ?object.
#}



# tutti i sequel dell'anime "Attack on Titan"
#SELECT ?subject ?object
#  WHERE {
#  ?subject dcterms:title "Attack on Titan" ;
#     anime:hasTVSerieSequel ?object .
#}

#SELECT ?subject ?object
#  WHERE {
#  ?subject dcterms:title "Attack on Titan" ;
#     anime:hasRelation ?object .
#}

#SELECT  ?subject ?property ?object
#  WHERE {
#  ?subject dcterms:title "Attack on Titan Season 2" ;
#  	?property ?object .
#}
#

################################# QUERY RELAZIONE #####################################

# 1. (Fabio) tutti gli anime adatti per adulti (NC-17) e con un particolare genere (Action) usciti negli ultimi 7 anni
#SELECT ?element ?category ?date (GROUP_CONCAT(?genreTitle; SEPARATOR=", ") AS ?genres)
#WHERE {
#  ?element rdf:type dbpedia:Anime ;
#    schema:contentRating anime:Rating_NC-17 ;
#    schema:genre ?genre .
#  ?genre dcterms:title ?genreTitle .
#  ?element schema:genre anime:Genre_Action .
#  OPTIONAL {									# select all the movies
#    ?element schema:datePublished ?date ;
#    BIND("Movie" AS ?category) .
#  } .
#  OPTIONAL {									# select all the tv series
#    ?element schema:airingStartDate ?date ;
#    BIND("Serie" AS ?category) .
#  } .
#  FILTER ( 
#    ?date >= now() - xsd:duration("P7Y")
#  )
#}
#GROUP BY ?element ?category ?date


# 3. (Fabio) dato un nome di anime, tabulare tutte le opere relative in ordine di uscita

#SELECT ?element ?date ?category ?sequel ?spinOff
#WHERE {
#  ?firstElement rdf:type dbpedia:Anime ;
#    dcterms:title ?originalTitle ;
#  	BIND(STR(?originalTitle) AS ?title) . 		# estrai tutti i titoli associati ed ignora @lingua
#  FILTER ( ?title = "Dragon Ball" ) .			# seleziona il titolo che corrisponde esattamente a Dragon Ball
#  ?element anime:hasRelation ?firstElement .	# find all the associated elements to the first element
#  OPTIONAL {									# select all the movies
#    ?element schema:datePublished ?date ;
#    BIND("Movie" AS ?category) .
#  } .
#  OPTIONAL {									# select all the tv series
#    ?element schema:airingStartDate ?date ;
#    BIND("Serie" AS ?category) .
#  } .
#  OPTIONAL {									# select all the sequels
#    ?element anime:hasSequel ?sequel .
#  } .
#  OPTIONAL {									# select all the spin offs
#    ?element anime:hasSpinOff ?spinOff .
#  } .
#}
#ORDER BY ?date									# order by date

# 6. (Fabio) i 5 anime pi√π ridoppiati
SELECT ?element ?streamingLanguage
WHERE {
  ?element rdf:type dbpedia:Anime ;
    anime:isStreamedOn ?streamingEvent ;
    schema:inLanguage ?streamingLanguage .
}

# 8. (Fabio) tutti gli anime currently airing e relative piattaforme di streaming
#SELECT ?element (GROUP_CONCAT(?platformTitle; SEPARATOR=", ") AS ?platforms)
#WHERE {
#  ?element rdf:type dbpedia:Anime ;
#    anime:creativeWorkStatus anime:CreativeWorkStatus_Finished_Airing .
#  ?element anime:isStreamedOn ?streamingEvent .
#  ?streamingEvent schema:publishedOn ?publishedOn .
#  ?publishedOn dcterms:title ?platformTitle .
#}
#GROUP BY ?element
